{"version":3,"file":"broadcast.js","sources":["../src/Helpers/Is.js","../src/Helpers/isFunction.js","../src/BroadcastEvent.js","../src/BroadcastReply.js","../src/BroadcastDispatch.js","../src/BroadcastManager.js"],"sourcesContent":["export default function(instance, proto) {\n    return instance instanceof proto;\n}\n","export default function(subject) {\n    return subject !== null && typeof subject === \"function\";\n}\n","import isFunction from './Helpers/isFunction.js';\n\nexport default class BroadcastEvent {\n\n    constructor(key, callback) {\n        this.key = key;\n        this.allowMultipleEmits = true;\n\n        if(isFunction(callback)) {\n            this.handle = callback;\n        }\n    }\n\n    allowsMultipleEmits() {\n        return !!this.allowMultipleEmits;\n    }\n\n    once() {\n        this.allowMultipleEmits = false;\n\n        return this;\n    }\n\n    handle() {\n        //\n    }\n\n}\n","export default class BroadcastReply {\n\n    constructor(key, callback) {\n        this.key = key;\n        this.allowMultipleRequests = false;\n\n        if(typeof callback === \"function\") {\n            this.handle = callback;\n        }\n    }\n\n    allowsMultipleRequests() {\n        return !!this.allowMultipleRequests;\n    }\n\n    once() {\n        this.allowMultipleRequests = true;\n\n        return this;\n    }\n\n    handle() {\n        //\n    }\n\n}\n","import is from './Helpers/Is.js';\nimport BroadcastEvent from './BroadcastEvent.js';\nimport BroadcastReply from './BroadcastReply.js';\n\nexport default class Dispatcher {\n\n    constructor(channel) {\n        this.channel = channel;\n        this._events = [];\n        this._replies = [];\n    }\n\n    createEvent(key, callback) {\n        return !is(key, BroadcastEvent) ? new BroadcastEvent(key, callback) : key;\n    }\n\n    createReply(key, callback) {\n        return !is(key, BroadcastReply) ? new BroadcastReply(key, callback) : key;\n    }\n\n    on(key, callback) {\n        const event = this.createEvent(key, callback);\n\n        this._events.push(event);\n\n        return event;\n    }\n\n    once(key, callback) {\n        const event = this.createEvent(key, callback);\n\n        this.on(event.once());\n\n        return event;\n    }\n\n    off(key) {\n        const removed = [];\n\n        for(let i in this._events) {\n            if(is(key, BroadcastEvent) && key == this._events[i] || key === this._events[i].key) {\n                removed.push(this._events[i]);\n                delete this._events[i];\n            }\n        }\n\n        return removed;\n    }\n\n    emit(event) {\n        const args = [].slice.call(arguments).slice(1);\n\n        for(let i in this._events) {\n            if(this._events[i].key === (event.key || event)) {\n                this._events[i].handle.apply(this, args);\n\n                if(!this._events[i].allowsMultipleEmits()) {\n                    delete this._events[i];\n                }\n            }\n        }\n    }\n\n    request(reply, context) {\n        const args = [].slice.call(arguments).slice(1);\n\n        if(!this._replies[reply.key || reply]) {\n            throw new Error('No BroadcastReply exists by the name \"'+(reply.key || reply)+'\"!');\n        }\n\n        const handle = this._replies[reply.key || reply].handle;\n\n        return new Promise(function(resolve, reject) {\n            handle.apply(this, [resolve, reject].concat(args));\n        });\n    }\n\n    reply(key, callback) {\n        const reply = this.createReply(key, callback);\n\n        return this._replies[reply.key] = reply;\n    }\n\n    stopReply(key) {\n        delete this._replies[reply.key || reply];\n    }\n\n}\n","//import 'es6-promise/auto';\nimport is from './Helpers/Is.js';\nimport BroadcastDispatch from './BroadcastDispatch.js';\n\nexport default class BroadcastManager {\n\n    constructor(channel) {\n        this._dispatchers = {};\n        this.defaultChannel = 'app';\n        this.dispatch(channel || this.defaultChannel);\n    }\n\n    dispatch(channel) {\n        channel || (channel = this.defaultChannel);\n\n        if(this.doesDispatchExist(channel)) {\n            return this._dispatchers[channel];\n        }\n\n        return this.registerDispatch(new BroadcastDispatch(channel));\n    }\n\n    doesDispatchExist(instance) {\n        return !!this._dispatchers[instance.channel || instance];\n    }\n\n    registerDispatch(instance) {\n        if(!is(instance, BroadcastDispatch)) {\n            throw new Error('The argument must be an instance of Broadcast/BroadcastDispatch!');\n        }\n\n        if(this.doesDispatchExist(instance.channel)) {\n            throw new Error('There is already a Broadcast/BroadcastDispatch instance assigned to \"'+instance.channel+'\"!');\n        }\n\n        return this._dispatchers[instance.channel] = instance;\n    }\n\n    unregisterDispatch(dispatch) {\n        unset(this._dispatchers[dispatch.channel || dispatch]);\n    }\n\n}\n"],"names":["instance","proto","subject","BroadcastEvent","key","callback","allowMultipleEmits","isFunction","handle","BroadcastReply","allowMultipleRequests","Dispatcher","channel","_events","_replies","is","event","createEvent","push","on","once","removed","i","args","slice","call","arguments","apply","allowsMultipleEmits","reply","context","Error","Promise","resolve","reject","concat","createReply","BroadcastManager","_dispatchers","defaultChannel","dispatch","doesDispatchExist","registerDispatch","BroadcastDispatch"],"mappings":"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"}