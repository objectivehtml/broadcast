{"version":3,"file":"broadcast.js","sources":["../src/Helpers/Is.js","../src/Helpers/isFunction.js","../src/BroadcastEvent.js","../src/BroadcastReply.js","../src/BroadcastDispatch.js","../src/BroadcastManager.js"],"sourcesContent":["export default function(instance, proto) {\n    return instance instanceof proto;\n}\n","export default function(subject) {\n    return subject !== null && typeof subject === \"function\";\n}\n","import isFunction from './Helpers/isFunction.js';\n\nexport default class BroadcastEvent {\n\n    constructor(key, callback) {\n        this.key = key;\n        this.allowMultipleEmits = true;\n\n        if(isFunction(callback)) {\n            this.handle = callback;\n        }\n    }\n\n    allowsMultipleEmits() {\n        return !!this.allowMultipleEmits;\n    }\n\n    once() {\n        this.allowMultipleEmits = false;\n\n        return this;\n    }\n\n    handle() {\n        //\n    }\n\n}\n","export default class BroadcastReply {\n\n    constructor(key, callback) {\n        this.key = key;\n        this.allowMultipleRequests = false;\n\n        if(typeof callback === \"function\") {\n            this.handle = callback;\n        }\n    }\n\n    allowsMultipleRequests() {\n        return !!this.allowMultipleRequests;\n    }\n\n    once() {\n        this.allowMultipleRequests = true;\n\n        return this;\n    }\n\n    handle() {\n        //\n    }\n\n}\n","import is from './Helpers/Is.js';\nimport BroadcastEvent from './BroadcastEvent.js';\nimport BroadcastReply from './BroadcastReply.js';\n\nexport default class Dispatcher {\n\n    constructor(channel) {\n        this.channel = channel;\n        this._events = [];\n        this._replies = [];\n    }\n\n    createEvent(key, callback) {\n        return !is(key, BroadcastEvent) ? new BroadcastEvent(key, callback) : key;\n    }\n\n    hasEvent(key) {\n        return !!this.getEvent(key);\n    }\n\n    getEvent(key) {\n        return this._events[key] || null;\n    }\n\n    getEvents() {\n        return this._events;\n    }\n\n    on(key, callback) {\n        const event = this.createEvent(key, callback);\n\n        this._events.push(event);\n\n        return event;\n    }\n\n    once(key, callback) {\n        const event = this.createEvent(key, callback);\n\n        this.on(event.once());\n\n        return event;\n    }\n\n    off(key) {\n        const removed = [];\n\n        for(let i in this._events) {\n            if(is(key, BroadcastEvent) && key == this._events[i] || key === this._events[i].key) {\n                removed.push(this._events[i]);\n                delete this._events[i];\n            }\n        }\n\n        return removed;\n    }\n\n    emit(event) {\n        const args = [].slice.call(arguments).slice(1);\n\n        for(let i in this._events) {\n            if(this._events[i].key === (event.key || event)) {\n                this._events[i].handle.apply(this, args);\n\n                if(!this._events[i].allowsMultipleEmits()) {\n                    delete this._events[i];\n                }\n            }\n        }\n    }\n\n    createReply(key, callback) {\n        return !is(key, BroadcastReply) ? new BroadcastReply(key, callback) : key;\n    }\n\n    hasReply(key) {\n        return !!this.getReply(key);\n    }\n\n    getReply(key) {\n        return this._replies[key] || null;\n    }\n\n    getReplies() {\n        return this._replies;\n    }\n\n    request(reply, context) {\n        const args = [].slice.call(arguments).slice(1);\n\n        if(!this._replies[reply.key || reply]) {\n            throw new Error('No BroadcastReply exists by the name \"'+(reply.key || reply)+'\"!');\n        }\n\n        const handle = this._replies[reply.key || reply].handle;\n\n        return new Promise(function(resolve, reject) {\n            handle.apply(this, [resolve, reject].concat(args));\n        });\n    }\n\n    reply(key, callback) {\n        const reply = this.createReply(key, callback);\n\n        return this._replies[reply.key] = reply;\n    }\n\n    stopReply(key) {\n        delete this._replies[reply.key || reply];\n    }\n\n}\n","//import 'es6-promise/auto';\nimport is from './Helpers/Is.js';\nimport BroadcastDispatch from './BroadcastDispatch.js';\n\nexport default class BroadcastManager {\n\n    constructor(channel) {\n        this._dispatchers = {};\n        this.defaultChannel = 'app';\n        this.dispatch(channel || this.defaultChannel);\n    }\n\n    dispatch(channel) {\n        channel || (channel = this.defaultChannel);\n\n        if(this.doesDispatchExist(channel)) {\n            return this._dispatchers[channel];\n        }\n\n        return this.registerDispatch(new BroadcastDispatch(channel));\n    }\n\n    doesDispatchExist(instance) {\n        return !!this._dispatchers[instance.channel || instance];\n    }\n\n    registerDispatch(instance) {\n        if(!is(instance, BroadcastDispatch)) {\n            throw new Error('The argument must be an instance of Broadcast/BroadcastDispatch!');\n        }\n\n        if(this.doesDispatchExist(instance.channel)) {\n            throw new Error('There is already a Broadcast/BroadcastDispatch instance assigned to \"'+instance.channel+'\"!');\n        }\n\n        return this._dispatchers[instance.channel] = instance;\n    }\n\n    unregisterDispatch(dispatch) {\n        unset(this._dispatchers[dispatch.channel || dispatch]);\n    }\n\n}\n"],"names":["instance","proto","subject","BroadcastEvent","key","callback","allowMultipleEmits","isFunction","handle","BroadcastReply","allowMultipleRequests","Dispatcher","channel","_events","_replies","is","getEvent","event","createEvent","push","on","once","removed","i","args","slice","call","arguments","apply","allowsMultipleEmits","getReply","reply","context","Error","Promise","resolve","reject","concat","createReply","BroadcastManager","_dispatchers","defaultChannel","dispatch","doesDispatchExist","registerDispatch","BroadcastDispatch"],"mappings":"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"}