{"version":3,"file":"broadcast.js","sources":["../src/Helpers/Is.js","../src/Helpers/isFunction.js","../src/BroadcastEvent.js","../src/BroadcastReply.js","../src/BroadcastDispatch.js","../src/BroadcastManager.js"],"sourcesContent":["export default function(instance, proto) {\n    return instance instanceof proto;\n}\n","export default function(subject) {\n    return subject !== null && typeof subject === \"function\";\n}\n","import isFunction from './Helpers/isFunction.js';\n\nexport default class BroadcastEvent {\n\n    constructor(key, callback) {\n        this.key = key;\n        this.allowMultipleEmits = true;\n\n        if(isFunction(callback)) {\n            this.handle = callback;\n        }\n    }\n\n    allowsMultipleEmits() {\n        return !!this.allowMultipleEmits;\n    }\n\n    once() {\n        this.allowMultipleEmits = false;\n\n        return this;\n    }\n\n    handle() {\n        //\n    }\n\n}\n","export default class BroadcastReply {\n\n    constructor(key, callback) {\n        this.key = key;\n        this.allowMultipleRequests = false;\n\n        if(typeof callback === \"function\") {\n            this.handle = callback;\n        }\n    }\n\n    allowsMultipleRequests() {\n        return !!this.allowMultipleRequests;\n    }\n\n    once() {\n        this.allowMultipleRequests = true;\n\n        return this;\n    }\n\n    handle() {\n        //\n    }\n\n}\n","import is from './Helpers/Is.js';\nimport BroadcastEvent from './BroadcastEvent.js';\nimport BroadcastReply from './BroadcastReply.js';\n\nexport default class Dispatcher {\n\n    constructor(channel) {\n        this.channel = channel;\n        this._events = [];\n        this._replies = [];\n    }\n\n    createEvent(key, callback) {\n        return !is(key, BroadcastEvent) ? new BroadcastEvent(key, callback) : key;\n    }\n\n    hasEvent(key) {\n        return !!this.getEvent(key);\n    }\n\n    getEvent(key) {\n        return this._events[key] || null;\n    }\n\n    setEvent(key, value) {\n        if(key instanceof BroadcastEvent) {\n            value = key;\n            key = value.key;\n        }\n\n        if(!value instanceof BroadcastEvent) {\n            throw new Error('The value argument must be an instance of BroadcastEvent');\n        }\n\n        return this._events[key] = value;\n    }\n\n    getEvents() {\n        return this._events;\n    }\n\n    on(key, callback) {\n        const event = this.createEvent(key, callback);\n\n        this._events.push(event);\n\n        return event;\n    }\n\n    once(key, callback) {\n        const event = this.createEvent(key, callback);\n\n        this.on(event.once());\n\n        return event;\n    }\n\n    off(key) {\n        const removed = [];\n\n        for(let i in this._events) {\n            if(is(key, BroadcastEvent) && key == this._events[i] || key === this._events[i].key) {\n                removed.push(this._events[i]);\n                delete this._events[i];\n            }\n        }\n\n        return removed;\n    }\n\n    emit(event) {\n        const args = [].slice.call(arguments).slice(1);\n\n        for(let i in this._events) {\n            if(this._events[i].key === (event.key || event)) {\n                this._events[i].handle.apply(this, args);\n\n                if(!this._events[i].allowsMultipleEmits()) {\n                    delete this._events[i];\n                }\n            }\n        }\n    }\n\n    createReply(key, callback) {\n        return !is(key, BroadcastReply) ? new BroadcastReply(key, callback) : key;\n    }\n\n    hasReply(key) {\n        return !!this.getReply(key);\n    }\n\n    getReply(key) {\n        return this._replies[key] || null;\n    }\n\n    setReply(key, value) {\n        if(key instanceof BroadcastReply) {\n            value = key;\n            key = value.key;\n        }\n\n        if(!value instanceof BroadcastReply) {\n            throw new Error('The value argument must be an instance of BroadcastReply');\n        }\n\n        return this._replies[key] = value;\n    }\n\n    getReplies() {\n        return this._replies;\n    }\n\n    request(reply, context) {\n        const args = [].slice.call(arguments).slice(1);\n\n        if(!this._replies[reply.key || reply]) {\n            throw new Error('No BroadcastReply exists by the name \"'+(reply.key || reply)+'\"!');\n        }\n\n        const handle = this._replies[reply.key || reply].handle;\n\n        return new Promise(function(resolve, reject) {\n            handle.apply(this, [resolve, reject].concat(args));\n        });\n    }\n\n    reply(key, callback) {\n        const reply = this.createReply(key, callback);\n\n        return this._replies[reply.key] = reply;\n    }\n\n    stopReply(key) {\n        delete this._replies[reply.key || reply];\n    }\n\n}\n","//import 'es6-promise/auto';\nimport is from './Helpers/Is.js';\nimport BroadcastDispatch from './BroadcastDispatch.js';\n\nexport default class BroadcastManager {\n\n    constructor(channel) {\n        this._dispatchers = {};\n        this.defaultChannel = 'app';\n        this.dispatch(channel || this.defaultChannel);\n    }\n\n    dispatch(channel) {\n        channel || (channel = this.defaultChannel);\n\n        if(this.doesDispatchExist(channel)) {\n            return this._dispatchers[channel];\n        }\n\n        return this.registerDispatch(new BroadcastDispatch(channel));\n    }\n\n    doesDispatchExist(instance) {\n        return !!this._dispatchers[instance.channel || instance];\n    }\n\n    registerDispatch(instance) {\n        if(!is(instance, BroadcastDispatch)) {\n            throw new Error('The argument must be an instance of Broadcast/BroadcastDispatch!');\n        }\n\n        if(this.doesDispatchExist(instance.channel)) {\n            throw new Error('There is already a Broadcast/BroadcastDispatch instance assigned to \"'+instance.channel+'\"!');\n        }\n\n        return this._dispatchers[instance.channel] = instance;\n    }\n\n    unregisterDispatch(dispatch) {\n        unset(this._dispatchers[dispatch.channel || dispatch]);\n    }\n\n}\n"],"names":["instance","proto","subject","BroadcastEvent","key","callback","allowMultipleEmits","isFunction","handle","BroadcastReply","allowMultipleRequests","Dispatcher","channel","_events","_replies","is","getEvent","value","Error","event","createEvent","push","on","once","removed","i","args","slice","call","arguments","apply","allowsMultipleEmits","getReply","reply","context","Promise","resolve","reject","concat","createReply","BroadcastManager","_dispatchers","defaultChannel","dispatch","doesDispatchExist","registerDispatch","BroadcastDispatch"],"mappings":"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"}